<!DOCTYPE html><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no"><meta http-equiv="Content-Language" content="en"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>BrowserChannel</title><link href="dossier.css" rel="stylesheet" type="text/css"><header><div><form><div><input type="search" placeholder="Search"></div></form></div></header><main><article><div class="parentlink"><b>Namespace:</b> <a href="namespace_goog_net.html">goog.net</a></div><div class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l76">View Source</a></div><h1>class BrowserChannel</h1><p>Encapsulates the logic for a single BrowserChannel.</p><h2 class="main">new BrowserChannel(<wbr>opt_clientVersion, opt_firstTestResults, opt_secondTestResults)</h2><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>opt_clientVersion<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>=</code><dd><p>An application-specific version number  that is sent to the server when connected.</p><dt>opt_firstTestResults<code>?<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array">Array</a>&lt;<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>&gt;=</code><dd><p>Previously determined results  of the first browser channel test.</p><dt>opt_secondTestResults<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a>=</code><dd><p>Previously determined results  of the second browser channel test.</p></dl></div></div><h2>Instance Methods</h2><div id="connect" class="function"><div><h3>connect(<wbr>testPath, channelPath, opt_extraParams, opt_oldSessionId, opt_oldArrayId)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l932">code »</a></span></h3><p>Starts the channel. This initiates connections to the server.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>testPath<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The path for the test connection.</p><dt>channelPath<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The path for the channel connection.</p><dt>opt_extraParams<code>?<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>=</code><dd><p>Extra parameter keys and values to add to  the requests.</p><dt>opt_oldSessionId<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>=</code><dd><p>Session ID from a previous session.</p><dt>opt_oldArrayId<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a>=</code><dd><p>The last array ID from a previous session.</p></dl></div></div></div></div><hr class="fn-sep"><div id="correctHostPrefix" class="function"><div><h3>correctHostPrefix(<wbr>serverHostPrefix)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l1922">code »</a></span></h3><p>Decides which host prefix should be used, if any. If there is a handler, allows the handler to validate a host prefix provided by the server, and optionally override it.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>serverHostPrefix<code>?<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The host prefix provided by the server.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code>?<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The host prefix to actually use, if any. Will return null  if the use of host prefixes was disabled via setAllowHostPrefix().</p></dl></div></div></div></div><hr class="fn-sep"><div id="createDataUri" class="function"><div><h3>createDataUri(<wbr>hostPrefix, path, opt_overridePort)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l2342">code »</a></span></h3><p>Creates a data Uri applying logic for secondary hostprefix, port overrides, and versioning.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>hostPrefix<code>?<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The host prefix.</p><dt>path<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The path on the host (may be absolute or relative).</p><dt>opt_overridePort<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a>=</code><dd><p>Optional override port.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_goog_Uri.html">goog.Uri</a></code><dd><p>The data URI.</p></dl></div></div></div></div><hr class="fn-sep"><div id="createXhrIo" class="function"><div><h3>createXhrIo(<wbr>hostPrefix)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l2391">code »</a></span></h3><p>Called when BC needs to create an XhrIo object. Override in a subclass if you need to customize the behavior, for example to enable the creation of XHR&#39;s capable of calling a secondary domain. Will also allow calling a secondary domain if withCredentials (CORS) is enabled.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>hostPrefix<code>?<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The host prefix, if we need an XhrIo object  capable of calling a secondary domain.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_goog_net_XhrIo.html">goog.net.XhrIo</a></code><dd><p>A new XhrIo object.</p></dl></div></div></div></div><hr class="fn-sep"><div id="disconnect" class="function"><div><h3>disconnect()<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l955">code »</a></span></h3><p>Disconnects and closes the channel.</p></div></div><hr class="fn-sep"><div id="getAllowChunkedMode" class="function"><div><h3>getAllowChunkedMode()<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l1168">code »</a></span></h3><p>Returns whether chunked mode is allowed. In certain debugging situations, it&#39;s useful for the application to have a way to disable chunked mode for a user.</p><div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code><dd><p>Whether chunked mode is allowed.</p></dl></div></div></div></div><hr class="fn-sep"><div id="getAllowHostPrefix" class="function"><div><h3>getAllowHostPrefix()<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l1131">code »</a></span></h3><p>Returns whether the channel allows the use of a subdomain. There may be cases where this isn&#39;t allowed.</p><div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code><dd><p>Whether a host prefix is allowed.</p></dl></div></div></div></div><hr class="fn-sep"><div id="getBackChannelMaxRetries" class="function"><div><h3>getBackChannelMaxRetries()<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l1283">code »</a></span></h3><div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>The max number of back-channel retries, which is a constant.</p></dl></div></div></div></div><hr class="fn-sep"><div id="getBackChannelUri" class="function"><div><h3>getBackChannelUri(<wbr>hostPrefix, path)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l2325">code »</a></span></h3><p>Gets the Uri used for the connection that receives data from the server.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>hostPrefix<code>?<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The host prefix.</p><dt>path<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The path on the host.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_goog_Uri.html">goog.Uri</a></code><dd><p>The back channel URI.</p></dl></div></div></div></div><hr class="fn-sep"><div id="getChannelDebug" class="function"><div><h3>getChannelDebug()<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l840">code »</a></span></h3><p>Returns the browserchannel logger.</p><div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_goog_net_ChannelDebug.html">goog.net.ChannelDebug</a></code><dd><p>The channel debug object.</p></dl></div></div></div></div><hr class="fn-sep"><div id="getExtraHeaders" class="function"><div><h3>getExtraHeaders()<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l1061">code »</a></span></h3><p>Returns the extra HTTP headers to add to all the requests sent to the server.</p><div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a></code><dd><p>The HTTP headers, or null.</p></dl></div></div></div></div><hr class="fn-sep"><div id="getFirstTestResults" class="function"><div><h3>getFirstTestResults()<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l2303">code »</a></span></h3><p>Gets the results for the first browser channel test</p><div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array">Array</a>&lt;<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>&gt;</code><dd><p>The results.</p></dl></div></div></div></div><hr class="fn-sep"><div id="getForwardChannelMaxRetries" class="function"><div><h3>getForwardChannelMaxRetries()<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l1254">code »</a></span></h3><div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>The max number of forward-channel retries, which will be 0 in fail-fast mode.</p></dl></div></div></div></div><hr class="fn-sep"><div id="getForwardChannelUri" class="function"><div><h3>getForwardChannelUri(<wbr>path)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l2291">code »</a></span></h3><p>Gets the Uri used for the connection that sends data to the server.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>path<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The path on the host.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_goog_Uri.html">goog.Uri</a></code><dd><p>The forward channel URI.</p></dl></div></div></div></div><hr class="fn-sep"><div id="getHandler" class="function"><div><h3>getHandler()<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l1112">code »</a></span></h3><p>Returns the handler used for channel callback events.</p><div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_goog_net_BrowserChannel_Handler.html">goog.net.BrowserChannel.Handler</a></code><dd><p>The handler.</p></dl></div></div></div></div><hr class="fn-sep"><div id="getLastArrayId" class="function"><div><h3>getLastArrayId()<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l1320">code »</a></span></h3><div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>The last array id received.</p></dl></div></div></div></div><hr class="fn-sep"><div id="getLastStatusCode" class="function"><div><h3>getLastStatusCode()<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l1312">code »</a></span></h3><p>Return the last status code received for a request.</p><div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>The last status code received for a request.</p></dl></div></div></div></div><hr class="fn-sep"><div id="getSecondTestResults" class="function"><div><h3>getSecondTestResults()<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l2314">code »</a></span></h3><p>Gets the results for the second browser channel test</p><div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code>?<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code><dd><p>The results. True -&gt; buffered connection,  False -&gt; unbuffered, null -&gt; unknown.</p></dl></div></div></div></div><hr class="fn-sep"><div id="getSessionId" class="function"><div><h3>getSessionId()<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l984">code »</a></span></h3><p>Returns the session id of the channel. Only available after the channel has been opened.</p><div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>Session ID.</p></dl></div></div></div></div><hr class="fn-sep"><div id="getState" class="function"><div><h3>getState()<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l1303">code »</a></span></h3><p>Returns the browser channel state.</p><div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>The current state of the browser channel.</p></dl></div></div></div></div><hr class="fn-sep"><div id="hasOutstandingRequests" class="function"><div><h3>hasOutstandingRequests()<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l1329">code »</a></span></h3><p>Returns whether there are outstanding requests servicing the channel.</p><div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code><dd><p>true if there are outstanding requests.</p></dl></div></div></div></div><hr class="fn-sep"><div id="isActive" class="function"><div><h3>isActive()<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l2406">code »</a></span></h3><p>Gets whether this channel is currently active. This is used to determine the length of time to wait before retrying. This call delegates to the handler.</p><div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code><dd><p>Whether the channel is currently active.</p></dl></div></div></div></div><hr class="fn-sep"><div id="isBuffered" class="function"><div><h3>isBuffered()<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l1156">code »</a></span></h3><p>Returns whether the channel is buffered or not. This state is valid for querying only after the test connection has completed. This may be queried in the goog.net.BrowserChannel.okToMakeRequest() callback. A channel may be buffered if the test connection determines that a chunked response could not be sent down within a suitable time.</p><div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code><dd><p>Whether the channel is buffered.</p></dl></div></div></div></div><hr class="fn-sep"><div id="isClosed" class="function"><div><h3>isClosed()<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l1293">code »</a></span></h3><p>Returns whether the channel is closed</p><div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code><dd><p>true if the channel is closed.</p></dl></div></div></div></div><hr class="fn-sep"><div id="notifyServerReachabilityEvent" class="function"><div><h3>notifyServerReachabilityEvent(<wbr>reachabilityType)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l2464">code »</a></span></h3><p>Notify the channel that a particular fine grained network event has occurred. Should be considered package-private.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>reachabilityType<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>The  reachability event type.</p></dl></div></div></div></div><hr class="fn-sep"><div id="onRequestComplete" class="function"><div><h3>onRequestComplete(<wbr>request)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l1987">code »</a></span></h3><p>Callback from ChannelRequest that indicates a request has completed.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>request<code><a href="class_goog_net_ChannelRequest.html">goog.net.ChannelRequest</a></code><dd><p>The request object.</p></dl></div></div></div></div><hr class="fn-sep"><div id="onRequestData" class="function"><div><h3>onRequestData(<wbr>request, responseText)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l1790">code »</a></span></h3><p>Callback from ChannelRequest for when new data is received</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>request<code><a href="class_goog_net_ChannelRequest.html">goog.net.ChannelRequest</a></code><dd><p>The request object.</p><dt>responseText<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The text of the response.</p></dl></div></div></div></div><hr class="fn-sep"><div id="sendMap" class="function"><div><h3>sendMap(<wbr>map, opt_context)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l1193">code »</a></span></h3><p>Sends a request to the server. The format of the request is a Map data structure of key/value pairs. These maps are then encoded in a format suitable for the wire and then reconstituted as a Map data structure that the server can process.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>map<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a></code><dd><p>The map to send.</p><dt>opt_context<code>?<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>=</code><dd><p>The context associated with the map.</p></dl></div></div></div></div><hr class="fn-sep"><div id="setAllowChunkedMode" class="function"><div><h3>setAllowChunkedMode(<wbr>allowChunkedMode)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l1179">code »</a></span></h3><p>Sets whether chunked mode is allowed. In certain debugging situations, it&#39;s useful for the application to have a way to disable chunked mode for a user.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>allowChunkedMode<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code><dd><p>Whether chunked mode is allowed.</p></dl></div></div></div></div><hr class="fn-sep"><div id="setAllowHostPrefix" class="function"><div><h3>setAllowHostPrefix(<wbr>allowHostPrefix)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l1142">code »</a></span></h3><p>Sets whether the channel allows the use of a subdomain. There may be cases where this isn&#39;t allowed, for example, logging in with troutboard where using a subdomain causes Apache to force the user to authenticate twice.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>allowHostPrefix<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code><dd><p>Whether a host prefix is allowed.</p></dl></div></div></div></div><hr class="fn-sep"><div id="setChannelDebug" class="function"><div><h3>setChannelDebug(<wbr>channelDebug)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l851">code »</a></span></h3><p>Set the browserchannel logger. TODO(user): Add interface for channel loggers or remove this function.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>channelDebug<code><a href="class_goog_net_ChannelDebug.html">goog.net.ChannelDebug</a></code><dd><p>The channel debug object.</p></dl></div></div></div></div><hr class="fn-sep"><div id="setExtraHeaders" class="function"><div><h3>setExtraHeaders(<wbr>extraHeaders)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l1071">code »</a></span></h3><p>Sets extra HTTP headers to add to all the requests sent to the server.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>extraHeaders<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a></code><dd><p>The HTTP headers, or null.</p></dl></div></div></div></div><hr class="fn-sep"><div id="setFailFast" class="function"><div><h3>setFailFast(<wbr>failFast)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l1225">code »</a></span></h3><p>When set to true, this changes the behavior of the forward channel so it will not retry requests; it will fail after one network failure, and if there was already one network failure, the request will fail immediately.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>failFast<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code><dd><p>Whether or not to fail fast.</p></dl></div></div></div></div><hr class="fn-sep"><div id="setForwardChannelMaxRetries" class="function"><div><h3>setForwardChannelMaxRetries(<wbr>retries)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l1264">code »</a></span></h3><p>Sets the maximum number of attempts to connect to the server for forward channel requests.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>retries<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>The maximum number of attempts.</p></dl></div></div></div></div><hr class="fn-sep"><div id="setForwardChannelRequestTimeout" class="function"><div><h3>setForwardChannelRequestTimeout(<wbr>timeoutMs)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l1274">code »</a></span></h3><p>Sets the timeout for a forward channel request.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>timeoutMs<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>The timeout in milliseconds.</p></dl></div></div></div></div><hr class="fn-sep"><div id="setHandler" class="function"><div><h3>setHandler(<wbr>handler)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l1121">code »</a></span></h3><p>Sets the handler used for channel callback events.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>handler<code><a href="class_goog_net_BrowserChannel_Handler.html">goog.net.BrowserChannel.Handler</a></code><dd><p>The handler to set.</p></dl></div></div></div></div><hr class="fn-sep"><div id="setParser" class="function"><div><h3>setParser(<wbr>parser)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l1340">code »</a></span></h3><p>Sets a new parser for the response payload. A custom parser may be set to avoid using eval(), for example. By default, the parser uses <code>goog.json.unsafeParse</code>.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>parser<code><a href="interface_goog_string_Parser.html">goog.string.Parser</a></code><dd><p>Parser.</p></dl></div></div></div></div><hr class="fn-sep"><div id="setReadyStateChangeThrottle" class="function"><div><h3>setReadyStateChangeThrottle(<wbr>throttle)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l1082">code »</a></span></h3><p>Sets the throttle for handling onreadystatechange events for the request.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>throttle<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>The throttle in ms. A value of zero indicates  no throttle.</p></dl></div></div></div></div><hr class="fn-sep"><div id="setRetryDelay" class="function"><div><h3>setRetryDelay(<wbr>baseDelayMs, delaySeedMs)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l2098">code »</a></span></h3><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>baseDelayMs<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>The base part of the retry delay, in ms.</p><dt>delaySeedMs<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>A random delay between 0 and this is added to  the base part.</p></dl></div></div></div></div><hr class="fn-sep"><div id="setSupportsCrossDomainXhrs" class="function"><div><h3>setSupportsCrossDomainXhrs(<wbr>supportCrossDomain)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l1101">code »</a></span></h3><p>Sets whether cross origin requests are supported for the browser channel.</p><p>Setting this allows the creation of requests to secondary domains and sends XHRs with the CORS withCredentials bit set to true.</p><p>In order for cross-origin requests to work, the server will also need to set CORS response headers as per: https://developer.mozilla.org/en-US/docs/HTTP_access_control</p><p>See <a href="class_goog_net_XhrIo.html#setWithCredentials"><code>goog.net.XhrIo#setWithCredentials</code></a>.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>supportCrossDomain<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code><dd><p>Whether cross domain XHRs are supported.</p></dl></div></div></div></div><hr class="fn-sep"><div id="shouldUseSecondaryDomains" class="function"><div><h3>shouldUseSecondaryDomains()<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l2520">code »</a></span></h3><p>Determines whether to use a secondary domain when the server gives us a host prefix. This allows us to work around browser per-domain connection limits.</p><p>Currently, we use secondary domains when using Trident&#39;s ActiveXObject, because it supports cross-domain requests out of the box. Note that in IE10 we no longer use ActiveX since it&#39;s not supported in Metro mode and IE10 supports XHR streaming.</p><p>If you need to use secondary domains on other browsers and IE10, you have two choices:  1) If you only care about browsers that support CORS  (https://developer.mozilla.org/en-US/docs/HTTP_access_control), you  can use <a href="class_goog_net_BrowserChannel.html#setSupportsCrossDomainXhrs"><code>#setSupportsCrossDomainXhrs</code></a> and set the appropriate  CORS response headers on the server.  2) Or, override this method in a subclass, and make sure that those  browsers use some messaging mechanism that works cross-domain (e.g  iframes and window.postMessage).</p><div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code><dd><p>Whether to use secondary domains.</p></dl></div></div></div></div><hr class="fn-sep"><div id="testConnectionBlocked" class="function"><div><h3>testConnectionBlocked(<wbr>testChannel)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l1777">code »</a></span></h3><p>Callback from BrowserTestChannel for when the channel is blocked.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>testChannel<code><a href="class_goog_net_BrowserTestChannel.html">goog.net.BrowserTestChannel</a></code><dd><p>The BrowserTestChannel.</p></dl></div></div></div></div><hr class="fn-sep"><div id="testConnectionFailure" class="function"><div><h3>testConnectionFailure(<wbr>testChannel, errorCode)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l1765">code »</a></span></h3><p>Callback from BrowserTestChannel for when the channel has an error.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>testChannel<code><a href="class_goog_net_BrowserTestChannel.html">goog.net.BrowserTestChannel</a></code><dd><p>The BrowserTestChannel.</p><dt>errorCode<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>The error code of the  failure.</p></dl></div></div></div></div><hr class="fn-sep"><div id="testConnectionFinished" class="function"><div><h3>testConnectionFinished(<wbr>testChannel, useChunked)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l1749">code »</a></span></h3><p>Callback from BrowserTestChannel for when the channel is finished.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>testChannel<code><a href="class_goog_net_BrowserTestChannel.html">goog.net.BrowserTestChannel</a></code><dd><p>The BrowserTestChannel.</p><dt>useChunked<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code><dd><p>Whether we can chunk responses.</p></dl></div></div></div></div><h2>Instance Properties</h2><div id="allowChunkedMode_" class="property"><dl><dt><a href="source/closure/goog/net/browserchannel.js.src.html#l1181">allowChunkedMode_</a><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code><dd>No description.</dl></div><div id="allowHostPrefix_" class="property"><dl><dt><a href="source/closure/goog/net/browserchannel.js.src.html#l1144">allowHostPrefix_</a><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code><dd>No description.</dl></div><h2>Static Functions</h2><div id="BrowserChannel.createChannelRequest" class="function"><div><h3>BrowserChannel.createChannelRequest(<wbr>channel, channelDebug, opt_sessionId, opt_requestId, opt_retryId)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l911">code »</a></span></h3><p>Instantiates a ChannelRequest with the given parameters. Overidden in tests.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>channel<code>(<a href="class_goog_net_BrowserChannel.html">goog.net.BrowserChannel</a>|<a href="class_goog_net_BrowserTestChannel.html">goog.net.BrowserTestChannel</a>)</code><dd><p>The BrowserChannel that owns this request.</p><dt>channelDebug<code><a href="class_goog_net_ChannelDebug.html">goog.net.ChannelDebug</a></code><dd><p>A ChannelDebug to use for  logging.</p><dt>opt_sessionId<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>=</code><dd><p>The session id for the channel.</p><dt>opt_requestId<code>(<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>|<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a>)=</code><dd><p>The request id for this request.</p><dt>opt_retryId<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a>=</code><dd><p>The retry id for this request.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_goog_net_ChannelRequest.html">goog.net.ChannelRequest</a></code><dd><p>The created channel request.</p></dl></div></div></div></div><hr class="fn-sep"><div id="BrowserChannel.getStatEventTarget" class="function"><div><h3>BrowserChannel.getStatEventTarget()<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l2453">code »</a></span></h3><p>Returns the singleton event target for stat events.</p><div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="class_goog_events_EventTarget.html">goog.events.EventTarget</a></code><dd><p>The event target for stat events.</p></dl></div></div></div></div><hr class="fn-sep"><div id="BrowserChannel.notifyStatEvent" class="function"><div><h3>BrowserChannel.notifyStatEvent(<wbr>stat)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l2476">code »</a></span></h3><p>Helper function to call the stat event callback.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>stat<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>The stat.</p></dl></div></div></div></div><hr class="fn-sep"><div id="BrowserChannel.notifyTimingEvent" class="function"><div><h3>BrowserChannel.notifyTimingEvent(<wbr>size, rtt, retries)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l2490">code »</a></span></h3><p>Helper function to notify listeners about POST request performance.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>size<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>Number of characters in the POST data.</p><dt>rtt<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>The amount of time from POST start to response.</p><dt>retries<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>The number of times the POST had to be retried.</p></dl></div></div></div></div><hr class="fn-sep"><div id="BrowserChannel.setEndThreadExecutionHook" class="function"><div><h3>BrowserChannel.setEndThreadExecutionHook(<wbr>endHook)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l876">code »</a></span></h3><p>Allows the application to set an execution hooks for when BrowserChannel stops processing requests. This is useful to track timing or logging special information. The function takes no parameters and return void.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>endHook<code>Function</code><dd><p>The function for the end hook.</p></dl></div></div></div></div><hr class="fn-sep"><div id="BrowserChannel.setStartThreadExecutionHook" class="function"><div><h3>BrowserChannel.setStartThreadExecutionHook(<wbr>startHook)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l865">code »</a></span></h3><p>Allows the application to set an execution hooks for when BrowserChannel starts processing requests. This is useful to track timing or logging special information. The function takes no parameters and return void.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>startHook<code>Function</code><dd><p>The function for the start hook.</p></dl></div></div></div></div><hr class="fn-sep"><div id="BrowserChannel.setTimeout" class="function"><div><h3>BrowserChannel.setTimeout(<wbr>fn, ms)<span class="codelink"><a href="source/closure/goog/net/browserchannel.js.src.html#l2418">code »</a></span></h3><p>Wrapper around SafeTimeout which calls the start and end execution hooks with a try...finally block.</p><div><div class="fn-details"><div><b>Parameters</b></div><dl><dt>fn<code>Function</code><dd><p>The callback function.</p><dt>ms<code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>The time in MS for the timer.</p></dl></div><div class="fn-details"><div><b>Returns</b></div><dl><dt><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>The ID of the timer.</p></dl></div></div></div></div><h2>Static Properties</h2><div id="BrowserChannel.BACK_CHANNEL_MAX_RETRIES" class="property"><dl><dt><a href="source/closure/goog/net/browserchannel.js.src.html#l497">BrowserChannel.BACK_CHANNEL_MAX_RETRIES</a><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>Maximum number of attempts to connect to the server for back channel requests.</p></dl></div><div id="BrowserChannel.FORWARD_CHANNEL_RETRY_TIMEOUT" class="property"><dl><dt><a href="source/closure/goog/net/browserchannel.js.src.html#l489">BrowserChannel.FORWARD_CHANNEL_RETRY_TIMEOUT</a><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>The timeout in milliseconds for a forward channel request.</p></dl></div><div id="BrowserChannel.INACTIVE_CHANNEL_RETRY_FACTOR" class="property"><dl><dt><a href="source/closure/goog/net/browserchannel.js.src.html#l514">BrowserChannel.INACTIVE_CHANNEL_RETRY_FACTOR</a><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>When retrying for an inactive channel, we will multiply the total delay by this number.</p></dl></div><div id="BrowserChannel.LATEST_CHANNEL_VERSION" class="property"><dl><dt><a href="source/closure/goog/net/browserchannel.js.src.html#l452">BrowserChannel.LATEST_CHANNEL_VERSION</a><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>The latest protocol version that this class supports. We request this version from the server when opening the connection. Should match com.google.net.browserchannel.BrowserChannel.LATEST_CHANNEL_VERSION.</p></dl></div><div id="BrowserChannel.MAGIC_RESPONSE_COOKIE" class="property"><dl><dt><a href="source/closure/goog/net/browserchannel.js.src.html#l821">BrowserChannel.MAGIC_RESPONSE_COOKIE</a><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code><dd><p>The normal response for forward channel requests. Used only before version 8 of the protocol.</p></dl></div><div id="BrowserChannel.OUTSTANDING_DATA_BACKCHANNEL_RETRY_CUTOFF" class="property"><dl><dt><a href="source/closure/goog/net/browserchannel.js.src.html#l832">BrowserChannel.OUTSTANDING_DATA_BACKCHANNEL_RETRY_CUTOFF</a><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>A guess at a cutoff at which to no longer assume the backchannel is dead when we are slow to receive data. Number in bytes.</p><p>Assumption: The worst bandwidth we work on is 50 kilobits/sec 50kbits/sec * (1 byte / 8 bits) * 6 sec dead backchannel timeout</p></dl></div><div id="BrowserChannel.RTT_ESTIMATE" class="property"><dl><dt><a href="source/closure/goog/net/browserchannel.js.src.html#l506">BrowserChannel.RTT_ESTIMATE</a><code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">number</a></code><dd><p>A number in MS of how long we guess the maxmium amount of time a round trip to the server should take. In the future this could be substituted with a real measurement of the RTT.</p></dl></div><h2>Types</h2><dl><dt><a href="enum_goog_net_BrowserChannel_ChannelType_.html">BrowserChannel.ChannelType_</a><dd><p>Internal enum type for the two browser channel channel types.</p><dt><a href="enum_goog_net_BrowserChannel_Error.html">BrowserChannel.Error</a><dd><p>Enum type for identifying a BrowserChannel error.</p><dt><a href="class_goog_net_BrowserChannel_Handler.html">BrowserChannel.Handler</a><dd><p>Abstract base class for the browser channel handler</p><dt><a href="class_goog_net_BrowserChannel_QueuedMap.html">BrowserChannel.QueuedMap</a><dd><p>Simple container class for a (mapId, map) pair.</p><dt><a href="enum_goog_net_BrowserChannel_ServerReachability.html">BrowserChannel.ServerReachability</a><dd><p>Types of events which reveal information about the reachability of the server.</p><dt><a href="class_goog_net_BrowserChannel_ServerReachabilityEvent.html">BrowserChannel.ServerReachabilityEvent</a><dd><p>Event class for goog.net.BrowserChannel.Event.SERVER_REACHABILITY_EVENT.</p><dt><a href="enum_goog_net_BrowserChannel_Stat.html">BrowserChannel.Stat</a><dd><p>Enum that identifies events for statistics that are interesting to track.</p><dt><a href="class_goog_net_BrowserChannel_StatEvent.html">BrowserChannel.StatEvent</a><dd><p>Event class for goog.net.BrowserChannel.Event.STAT_EVENT</p><dt><a href="enum_goog_net_BrowserChannel_State.html">BrowserChannel.State</a><dd><p>Enum type for the browser channel state machine.</p><dt><a href="class_goog_net_BrowserChannel_TimingEvent.html">BrowserChannel.TimingEvent</a><dd><p>Event class for goog.net.BrowserChannel.Event.TIMING_EVENT</p></dl></article><nav><h3><a href="index.html">Overview</a></h3><div><input type="checkbox" id="nav-types" checked/><label for="nav-types"><h3><span class="selectable">Types</span></h3></label><div id="nav-types-view"></div></div></nav></main><div class="pre-footer"><div></div></div><footer><div><a href="https://github.com/jleyba/js-dossier">Generated by dossier</a></div></footer><script src="types.js"></script><script src="dossier.js"></script>